#!/usr/bin/env python3

import argparse
import sys
from cli import analysis, stage


def brave_executor(cmd_line_args):
    """
    main pipeline executor
    """
    parser = argparse.ArgumentParser(
        description="BRAVE - Bulk RNA-seq Analysis and Visualization Engine"
    )
    # Create a sub-parser
    subparsers = parser.add_subparsers(title="module", dest="module")

    # Create a parser for analysis module
    subparser_analysis = subparsers.add_parser(
        'analysis',
        help=analysis.DESCRIPTION
    )
    analysis.parse_args(subparser_analysis)

    # Create a parser for stage module
    subparser_stage = subparsers.add_parser(
        'stage',
        help=stage.DESCRIPTION
    )
    stage.parse_args(subparser_stage)

    # Parse the command line arguments
    args = parser.parse_args(cmd_line_args)

    # Check for the selected module/sub-command
    if args.module == "analysis":
        analysis.execute_workflow(args)
    elif args.module == 'stage':
        stage.execute_workflow(args)


if __name__ == "__main__":
    brave_executor(sys.argv[1:])
